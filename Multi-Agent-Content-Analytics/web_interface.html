<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent Content Analytics - Web Interface</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .section h2 {
            color: #34495e;
            margin-top: 0;
        }
        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
            resize: vertical;
            box-sizing: border-box;
        }
        select, button {
            padding: 10px 20px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background-color: #ecf0f1;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success {
            background-color: #d5f4e6;
            color: #27ae60;
            border: 1px solid #27ae60;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .quick-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .example-card {
            padding: 15px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .example-card:hover {
            background-color: #f0f0f0;
        }
        .example-card h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        .example-card p {
            margin: 0;
            font-size: 14px;
            color: #7f8c8d;
        }
        .api-status {
            text-align: center;
            margin-bottom: 20px;
        }
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .result-card {
            background-color: white;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .result-card h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 16px;
        }
        .result-card p {
            margin: 5px 0;
            font-size: 14px;
            line-height: 1.4;
        }
        .raw-results {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .raw-results button {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé¨ Multi-Agent Content Analytics</h1>
        <p style="text-align: center; color: #7f8c8d;">
            Analyze movie scripts, stories, and content using AI agents running in Docker
        </p>

        <!-- API Status -->
        <div class="api-status">
            <button onclick="checkApiStatus()">Check API Status</button>
            <div id="apiStatus"></div>
        </div>

        <!-- Content Analysis Section -->
        <div class="section">
            <h2>üìù Analyze Your Content with AI Agents</h2>
            <div>
                <label for="contentInput"><strong>Enter your movie script or content:</strong></label>
                <textarea id="contentInput" placeholder="Paste your movie script, story, or any content here...

Example:
FADE IN:

EXT. SPACESHIP - DAY

The massive starship hovers above Earth. Captain Sarah looks out the window at her home planet one last time before the journey to Mars begins.

SARAH
This is it. No turning back now.

The engines ignite with a brilliant blue flame."></textarea>
            </div>
            
            <div>
                <label for="agentSelect"><strong>Choose AI Agent:</strong></label>
                <select id="agentSelect">
                    <option value="script_summarizer">üìù Script Summarizer - Extract scenes, characters, themes</option>
                    <option value="genre_classifier">üéØ Genre Classifier - Identify genre, mood, audience</option>
                    <option value="marketing_agent">üìà Marketing Agent - Get marketing strategy & insights</option>
                </select>
                
                <button onclick="analyzeWithAgent()" id="analyzeAgentBtn">üöÄ Analyze with Agent</button>
            </div>

            <div id="agentResults"></div>
        </div>

        <!-- Quick Examples -->
        <div class="section">
            <h2>üöÄ Quick Examples</h2>
            <p>Click on any example below to try it:</p>
            
            <div class="quick-examples">
                <div class="example-card" onclick="loadExample('scifi')">
                    <h4>üõ∏ Sci-Fi Script</h4>
                    <p>Space exploration and alien contact</p>
                </div>
                
                <div class="example-card" onclick="loadExample('romance')">
                    <h4>üíï Romance Script</h4>
                    <p>Coffee shop meet-cute scene</p>
                </div>
                
                <div class="example-card" onclick="loadExample('action')">
                    <h4>üî• Action Script</h4>
                    <p>High-stakes chase sequence</p>
                </div>
                
                <div class="example-card" onclick="loadExample('horror')">
                    <h4>üëª Horror Script</h4>
                    <p>Mysterious haunted house</p>
                </div>
            </div>
        </div>

        <!-- Available Agents -->
        <div class="section">
            <h2>ü§ñ Available AI Agents</h2>
            <button onclick="getAgents()">Load Available Agents</button>
            <div id="agentsResults"></div>
        </div>

        <!-- API Documentation -->
        <div class="section">
            <h2>üìñ API Endpoints</h2>
            <div style="font-family: monospace; background-color: white; padding: 15px; border-radius: 5px;">
                <strong>Base URL:</strong> http://localhost:8000<br><br>
                <strong>GET /</strong> - API status<br>
                <strong>GET /health</strong> - Health check<br>
                <strong>GET /agents</strong> - List available agents<br>
                <strong>POST /analyze</strong> - Analyze content<br>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:8000';

        // Example content
        const examples = {
            scifi: `FADE IN:

EXT. MARS COLONY - DAY

The red planet stretches endlessly. COMMANDER ALEX (40s) stands at the observation deck, watching Earth rise over the Martian horizon.

ALEX
(into comm device)
Mission Control, we've detected something unusual. There are structures here that predate human arrival.

A shadow moves across the ancient alien ruins in the distance.

FADE OUT.`,

            romance: `INT. COFFEE SHOP - MORNING

SARAH (28) sits alone, typing on her laptop. JAMES (30) approaches nervously with two coffee cups.

JAMES
Excuse me, I couldn't help but notice you're writing something. I'm a writer too.

SARAH
(looking up, smiling)
Really? What do you write?

Their eyes meet. Something magical happens.`,

            action: `EXT. CITY ROOFTOP - NIGHT

AGENT CARTER sprints across rooftops, bullets whizzing past. The helicopter searchlight sweeps the area.

CARTER
(into earpiece)
Package secured. Need immediate extraction!

Carter leaps between buildings as explosions light up the night sky behind them.

CARTER (CONT'D)
This mission just went sideways!`,

            horror: `INT. ABANDONED MANSION - NIGHT

The floorboards creak as JENNY (20s) slowly climbs the dusty staircase. Her flashlight flickers ominously.

JENNY
(whispering)
Hello? Is anyone there?

A door slams shut somewhere in the darkness. The temperature drops noticeably.

JENNY (CONT'D)
(voice trembling)
I shouldn't have come here alone.

A child's laughter echoes from the walls.`
        };

        async function checkApiStatus() {
            const statusDiv = document.getElementById('apiStatus');
            try {
                const response = await fetch(`${API_URL}/`);
                const data = await response.json();
                statusDiv.innerHTML = `<div class="status success">‚úÖ API is running: ${data.message}</div>`;
            } catch (error) {
                statusDiv.innerHTML = `<div class="status error">‚ùå API not accessible. Make sure Docker container is running.</div>`;
            }
        }

        async function analyzeWithAgent() {
            const content = document.getElementById('contentInput').value.trim();
            const selectedAgent = document.getElementById('agentSelect').value;
            const resultsDiv = document.getElementById('agentResults');
            const analyzeBtn = document.getElementById('analyzeAgentBtn');

            if (!content) {
                alert('Please enter some content to analyze!');
                return;
            }

            analyzeBtn.disabled = true;
            analyzeBtn.textContent = 'üîÑ Analyzing...';
            
            try {
                const response = await fetch(`${API_URL}/agent/${selectedAgent}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        content: content,
                        agent_name: selectedAgent
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    resultsDiv.innerHTML = formatAgentResults(data);
                } else {
                    resultsDiv.innerHTML = `<div class="status error">Error: ${data.detail || 'Analysis failed'}</div>`;
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status error">Error: ${error.message}</div>`;
            } finally {
                analyzeBtn.disabled = false;
                analyzeBtn.textContent = 'ÔøΩ Analyze with Agent';
            }
        }

        function formatAgentResults(data) {
            const agent = data.agent;
            const results = data.results;
            
            let formattedHTML = `
                <h3>ü§ñ ${agent.replace('_', ' ').toUpperCase()} Results</h3>
                <div class="status success">‚úÖ Analysis completed in ${data.processing_time || 0}ms</div>
                <div class="results-grid">
            `;

            if (agent === 'script_summarizer') {
                formattedHTML += `
                    <div class="result-card">
                        <h4>üìä Script Overview</h4>
                        <p><strong>Summary:</strong> ${results.summary}</p>
                        <p><strong>Word Count:</strong> ${results.word_count}</p>
                        <p><strong>Estimated Runtime:</strong> ${results.estimated_runtime}</p>
                        <p><strong>Dialogue Ratio:</strong> ${(results.dialogue_ratio * 100).toFixed(1)}%</p>
                    </div>
                    <div class="result-card">
                        <h4>üé≠ Characters</h4>
                        <p>${results.characters.length > 0 ? results.characters.join(', ') : 'No clear character names detected'}</p>
                    </div>
                    <div class="result-card">
                        <h4>üè† Scenes</h4>
                        <p>${results.scenes.length > 0 ? results.scenes.join(', ') : 'No scene headers detected'}</p>
                    </div>
                    <div class="result-card">
                        <h4>üé® Themes & Genre</h4>
                        <p><strong>Themes:</strong> ${results.themes.join(', ')}</p>
                        <p><strong>Suggested Genre:</strong> ${results.suggested_genre}</p>
                    </div>
                `;
            } else if (agent === 'genre_classifier') {
                formattedHTML += `
                    <div class="result-card">
                        <h4>üéØ Genre Classification</h4>
                        <p><strong>Primary Genre:</strong> ${results.primary_genre.toUpperCase()} (${(results.confidence * 100).toFixed(1)}% confident)</p>
                        <p><strong>Content Rating:</strong> ${results.content_rating}</p>
                    </div>
                    <div class="result-card">
                        <h4>üé≠ Mood Analysis</h4>
                        <p><strong>Overall Mood:</strong> ${results.mood.overall}</p>
                        <p><strong>Intensity:</strong> ${results.mood.intensity}</p>
                        <p><strong>Emotional Range:</strong> ${results.mood.emotional_range}</p>
                    </div>
                    <div class="result-card">
                        <h4>üë• Target Audience</h4>
                        <p>${results.target_audience.join(', ')}</p>
                    </div>
                    <div class="result-card">
                        <h4>üìã Content Characteristics</h4>
                        <p>${results.characteristics.join(', ')}</p>
                    </div>
                    <div class="result-card">
                        <h4>üìä Genre Scores</h4>
                        ${Object.entries(results.genre_scores)
                            .sort((a, b) => b[1] - a[1])
                            .slice(0, 5)
                            .map(([genre, score]) => `<p>${genre}: ${(score * 100).toFixed(1)}%</p>`)
                            .join('')}
                    </div>
                `;
            } else if (agent === 'marketing_agent') {
                formattedHTML += `
                    <div class="result-card">
                        <h4>üéØ Target Demographics</h4>
                        <p><strong>Primary Age Group:</strong> ${results.target_demographics.primary_age_group.replace('_', ' ')}</p>
                        <p><strong>Gender Appeal:</strong> ${results.target_demographics.gender_appeal}</p>
                    </div>
                    <div class="result-card">
                        <h4>üöÄ Marketing Hooks</h4>
                        ${results.marketing_hooks.map(hook => `<p>‚Ä¢ ${hook}</p>`).join('')}
                    </div>
                    <div class="result-card">
                        <h4>üì∫ Marketing Channels</h4>
                        ${results.recommended_channels.map(channel => 
                            `<p><strong>${channel.platform}:</strong> ${channel.priority} priority (${channel.content_type})</p>`
                        ).join('')}
                    </div>
                    <div class="result-card">
                        <h4>üé¨ Similar Content</h4>
                        <p>${results.similar_content.join(', ')}</p>
                    </div>
                    <div class="result-card">
                        <h4>üí∞ Budget Allocation</h4>
                        ${Object.entries(results.budget_allocation).map(([category, percentage]) => 
                            `<p><strong>${category.replace('_', ' ')}:</strong> ${percentage}</p>`
                        ).join('')}
                    </div>
                    <div class="result-card">
                        <h4>üé™ Release Strategy</h4>
                        <p><strong>Season:</strong> ${results.release_strategy.recommended_season}</p>
                        <p><strong>Platform:</strong> ${results.release_strategy.platform_strategy}</p>
                        <p><strong>International:</strong> ${results.release_strategy.international_strategy}</p>
                    </div>
                    <div class="result-card">
                        <h4>‚ú® Taglines</h4>
                        ${results.taglines.map(tagline => `<p>‚Ä¢ "${tagline}"</p>`).join('')}
                    </div>
                `;
            }

            formattedHTML += `
                </div>
                <div class="raw-results">
                    <h4>üìÑ Raw JSON Response <button onclick="toggleRawResults()" id="toggleBtn">Show</button></h4>
                    <pre id="rawResults" style="display: none;">${JSON.stringify(data, null, 2)}</pre>
                </div>
            `;

            return formattedHTML;
        }

        function toggleRawResults() {
            const rawResults = document.getElementById('rawResults');
            const toggleBtn = document.getElementById('toggleBtn');
            
            if (rawResults.style.display === 'none') {
                rawResults.style.display = 'block';
                toggleBtn.textContent = 'Hide';
            } else {
                rawResults.style.display = 'none';
                toggleBtn.textContent = 'Show';
            }
        }

        async function getAgents() {
            const resultsDiv = document.getElementById('agentsResults');
            
            try {
                const response = await fetch(`${API_URL}/agents`);
                const data = await response.json();
                
                if (response.ok && data.agents) {
                    let agentsHTML = '<h3>ü§ñ Available Agents</h3><div class="results">';
                    data.agents.forEach(agent => {
                        agentsHTML += `<strong>${agent.name}</strong>: ${agent.description} (${agent.status})\n`;
                    });
                    agentsHTML += '</div>';
                    resultsDiv.innerHTML = agentsHTML;
                } else {
                    resultsDiv.innerHTML = `<div class="status error">Could not load agents</div>`;
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status error">Error: ${error.message}</div>`;
            }
        }

        function loadExample(type) {
            document.getElementById('contentInput').value = examples[type];
            document.getElementById('analysisType').value = 'detailed';
        }

        // Check API status on page load
        document.addEventListener('DOMContentLoaded', checkApiStatus);
    </script>
</body>
</html>
