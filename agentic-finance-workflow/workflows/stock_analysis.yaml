workflow_id: "stock_analysis_pipeline"
name: "Stock Price Analysis Pipeline"
description: "Comprehensive workflow for analyzing stock price data including cleaning, validation, analysis, visualization, and recommendations"
version: "1.0"

global_config:
  data_source: "yahoo_finance"
  default_symbol: "AAPL"
  lookback_days: 252
  analysis_models:
    - "technical_indicators"
    - "volatility_modeling"
    - "momentum_analysis"

error_handling:
  continue_on_error: false
  max_retries: 3
  retry_delay: 5
  escalate_to_human: true

human_review_required: false

steps:
  - step_id: "data_ingestion"
    agent_type: "cleaner"
    agent_config:
      cleaning_rules:
        handle_missing: "interpolate"
        outlier_method: "iqr"
        outlier_threshold: 3.0
        validate_business_hours: true
        validate_price_ranges: true
    input_mapping:
      data: "raw_stock_data"
      symbol: "target_symbol"
      data_type: "stock_prices"
    output_mapping:
      cleaned_data: "clean_stock_data"
      cleaning_report: "data_quality_report"
      data_quality_score: "quality_score"
    depends_on: []
    parallel: false
    retry_on_failure: true
    timeout_seconds: 300

  - step_id: "data_validation"
    agent_type: "validator"
    agent_config:
      validation_rules:
        price_consistency: true
        volume_validation: true
        temporal_consistency: true
        business_rules: true
      quality_threshold: 0.8
    input_mapping:
      data: "clean_stock_data"
      symbol: "target_symbol"
      quality_report: "data_quality_report"
    output_mapping:
      validated_data: "validated_stock_data"
      validation_report: "validation_results"
      anomalies: "detected_anomalies"
    depends_on: ["data_ingestion"]
    parallel: false
    retry_on_failure: true
    timeout_seconds: 180

  - step_id: "technical_analysis"
    agent_type: "analyzer"
    agent_config:
      analysis_type: "technical"
      indicators:
        - "sma_20"
        - "sma_50"
        - "ema_12"
        - "ema_26"
        - "rsi"
        - "macd"
        - "bollinger_bands"
        - "stochastic"
      timeframes: ["1d", "1w"]
    input_mapping:
      data: "validated_stock_data"
      symbol: "target_symbol"
      indicators: "analysis_models"
    output_mapping:
      technical_indicators: "technical_analysis_results"
      signals: "technical_signals"
      strength_score: "technical_strength"
    depends_on: ["data_validation"]
    parallel: true
    retry_on_failure: true
    timeout_seconds: 240

  - step_id: "risk_analysis"
    agent_type: "analyzer"
    agent_config:
      analysis_type: "risk"
      metrics:
        - "volatility"
        - "var_95"
        - "cvar_95"
        - "max_drawdown"
        - "sharpe_ratio"
        - "beta"
      benchmark: "SPY"
      confidence_level: 0.95
    input_mapping:
      data: "validated_stock_data"
      symbol: "target_symbol"
      benchmark_data: "benchmark_prices"
    output_mapping:
      risk_metrics: "risk_analysis_results"
      risk_score: "overall_risk_score"
      risk_classification: "risk_level"
    depends_on: ["data_validation"]
    parallel: true
    retry_on_failure: true
    timeout_seconds: 300

  - step_id: "visualization"
    agent_type: "visualizer"
    agent_config:
      chart_types:
        - "candlestick"
        - "volume"
        - "technical_indicators"
        - "risk_metrics"
      output_format: "interactive"
      time_range: "1y"
      include_annotations: true
    input_mapping:
      price_data: "validated_stock_data"
      technical_data: "technical_analysis_results"
      risk_data: "risk_analysis_results"
      symbol: "target_symbol"
    output_mapping:
      charts: "visualization_results"
      dashboard_url: "interactive_dashboard"
      static_charts: "chart_images"
    depends_on: ["technical_analysis", "risk_analysis"]
    parallel: false
    retry_on_failure: true
    timeout_seconds: 180

  - step_id: "recommendation_engine"
    agent_type: "recommender"
    agent_config:
      recommendation_type: "trading"
      strategy: "momentum_value"
      risk_tolerance: "moderate"
      time_horizon: "medium_term"
      confidence_threshold: 0.7
    input_mapping:
      price_data: "validated_stock_data"
      technical_signals: "technical_signals"
      risk_metrics: "risk_analysis_results"
      symbol: "target_symbol"
    output_mapping:
      recommendations: "trading_recommendations"
      action: "recommended_action"
      confidence: "recommendation_confidence"
      reasoning: "recommendation_rationale"
    depends_on: ["technical_analysis", "risk_analysis"]
    parallel: false
    retry_on_failure: true
    timeout_seconds: 120

metadata:
  created_by: "agentic_finance_system"
  created_at: "2025-08-27"
  tags: ["stock_analysis", "technical_analysis", "risk_management"]
  category: "equity_analysis"
  complexity: "intermediate"
  estimated_duration: "5-10 minutes"
